

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User Guide &mdash; wiki_aE 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gaussian" href="gaussian.html" />
    <link rel="prev" title="Welcome to wiki_aE’s documentation!" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> wiki_aE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-on-bluecrystal3">Install on BlueCrystal3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-on-bluecrystal3">Run on BlueCrystal3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faq">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gaussian.html">Gaussian</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="ENRICH.html">ENRICH</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wiki_aE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/user_guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-guide">
<span id="id1"></span><h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basics">
<span id="id2"></span><h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>Commands you need to type into your terminal window (after logging in to BlueCrystal) are written in block quotes as below. Notes are preceeded by a #:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>type_this_into_terminal_window
<span class="c1">#Helpful extra instructions, do not type this into the terminal window</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="install-on-bluecrystal3">
<span id="install-bc3"></span><h2>Install on BlueCrystal3<a class="headerlink" href="#install-on-bluecrystal3" title="Permalink to this headline">¶</a></h2>
<p><strong>0</strong> Get IT to allow you to use Gaussian on BlueCrystal, email <a class="reference external" href="mailto:hpc-help&#37;&#52;&#48;bristol&#46;ac&#46;uk">hpc-help<span>&#64;</span>bristol<span>&#46;</span>ac<span>&#46;</span>uk</a> asking them to set up and give your account access to use Gaussian</p>
<p><strong>1</strong> Get read access to this repository (email <a class="reference external" href="mailto:will&#46;gerrard&#37;&#52;&#48;bristol&#46;ac&#46;uk">will<span>&#46;</span>gerrard<span>&#64;</span>bristol<span>&#46;</span>ac<span>&#46;</span>uk</a> with your github account details or request access through github)</p>
<p><strong>2</strong> Set up your environment:</p>
<blockquote>
<div><p><strong>2.1</strong> Load the conda module</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load languages/python-anaconda-5.0.1-2.7
</pre></div>
</div>
</div></blockquote>
<p><strong>2.2</strong> Create a conda environment</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create --name myenv
</pre></div>
</div>
</div></blockquote>
<p><strong>2.3</strong> Install openbabel and numpy</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install -c openbabel -n myenv openbabel
conda install -n myenv numpy scipy
</pre></div>
</div>
</div></blockquote>
<p><strong>2.4</strong> Activate the environment you just made, this should put add “(myenv)” to the far left of where you input Commands</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> activate myenv
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p><strong>3</strong> Set up Github and get a copy of auto-ENRICH:</p>
<blockquote>
<div><p><strong>3.1</strong> Find your ssh key, we do this by first going to your home folder in BlueCrystal then opening .ssh/id_dsa.pub (a text file) containing your key</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim .ssh/id_dsa.pub
</pre></div>
</div>
<div class="figure" id="id4">
<img alt="_images/sshkey.png" src="_images/sshkey.png" />
<p class="caption"><span class="caption-text">Example ssh key</span></p>
</div>
</div></blockquote>
<p><strong>3.2</strong> Copy the key (all that text) then type :q! to exit</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>:q!
<span class="c1">#Close file</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>3.3</strong> Login to Github.com then go to Settings - SSH and GPG keys - New SSH key and paste the key and give it a simple title like BlueCrystal3</p>
<blockquote>
<div><div class="figure" id="id5">
<img alt="_images/ssh_github.png" src="_images/ssh_github.png" />
<p class="caption"><span class="caption-text">Navigate through github.com to input ssh key</span></p>
</div>
</div></blockquote>
<p><strong>3.4</strong> Enable git</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load tools/git-2.18.0
</pre></div>
</div>
</div></blockquote>
<p><strong>3.5</strong> Copy auto-ENRICH files, it’ll make a folder called auto-ENRICH containing all the files</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone --recurse-submodules git@github.com:wg12385/auto-ENRICH.git
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p><strong>4</strong> Automatically set up things so when you log in to be able to run auto-_ENRICH. If you don’t want to do this type the commands in step <strong>4.2</strong> into your terminal everytime you want to run auto-ENRICH</p>
<blockquote>
<div><p><strong>4.1</strong> Open .bashrc, this is a script that runs automatically when you log in to BlueCrystal3</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim .bashrc
</pre></div>
</div>
</div></blockquote>
<p><strong>4.2</strong> Tell BlueCrystal to automatically load python and git and then activate your conda environment.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load languages/python-anaconda-5.0.1-2.7
module load tools/git-2.18.0
<span class="nb">source</span> activate myenv
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="run-on-bluecrystal3">
<span id="run-bc3"></span><h2>Run on BlueCrystal3<a class="headerlink" href="#run-on-bluecrystal3" title="Permalink to this headline">¶</a></h2>
<p>auto-ENRICH automates moving from a conformational search output to getting out NMR parameters. Save the output of your conformational search to one .xyz file (that contains lots of conformers) for a particular molecule</p>
<p><strong>1</strong> Make a folder with the molecule name and put your .xyz file in it, cd into that folder</p>
<p><strong>2</strong> Copy the preferences file from the auto-ENRICH folder then open it and decide what you want to run. If the auto-ENRICH folder is 2 directories above your molecules folder (which you are now in) type:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp -rf ../../auto-ENRICH/ENRICH.prefs ./
<span class="c1">#The cp means copy, first place is where it&#39;s copying from,</span>
<span class="c1">#the other is where its copying to, your current directory</span>
<span class="c1">#If its more/less folders above use more/less ../&#39;s before the auto-ENRICH</span>
<span class="c1">#This applies for all that follows</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>3</strong> Edit the preferences</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim ENRICH.prefs
<span class="c1">#Press the i key then edit the file</span>
:wq
<span class="c1">#Save and then close the file</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>4</strong> Create geometry optimisation and frequency correction input files for Gaussian based on your choices in ENRICH.prefs by running xyz_to_opt.py script from the folder containing your .xyz file</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/xyz_to_opt.py
</pre></div>
</div>
</div></blockquote>
<p>This will produce an optcom folder filled with .com files and .qsub file(‘s)</p>
<p><strong>5</strong> Submit job files for optimisation and frequency correction (conformer relative energies)</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qsub molecule1_NMR_0.qsub
<span class="c1">#If you&#39;re submitting over 50 conformers you will have several of these to submitting</span>
qsub molecule1_NMR_1.qsub
qsub molecule1_NMR_2.qsub
<span class="c1"># ... ... ...</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>6</strong> Wait for the calculations to complete…</p>
<p><strong>7</strong> Run move_complete.py to sort your calculations into successes (they’ll be moved to a folder called optlog) and fails (failed folder)</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/move_complete.py
</pre></div>
</div>
</div></blockquote>
<p><strong>8</strong> Create NMR input files by running opt_to_nmr.py. This will also create a file called ‘population.txt’ containing conformer energies</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/opt_to_nmr.py
</pre></div>
</div>
</div></blockquote>
<p>This will produce an nmrcom folder filled with .com files and .qsub file(‘s)</p>
<p><strong>9</strong> Wait for the calculations to complete…</p>
<p><strong>10</strong> Run move_complete.py to sort your calculations into successes (they’ll be moved to a folder called nmrlog) and fails (failed folder)</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/move_complete.py
</pre></div>
</div>
</div></blockquote>
<p><strong>11</strong> Run nmr_process.py to get the raw DFT NMR experimental measurables out, this will be numbered based on atoms in the .xyz file and assumes all atoms inequivalent on NMR timescale (doesn’t deal with methyls/symmetry). This will produce an OUTPUT folder with the .xyz files for all your DFT geometry optimised conformers</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/nmr_process.py
</pre></div>
</div>
</div></blockquote>
<p><strong>12</strong> Produce equivalency file: Open one of the conformers from your original input .xyz in PyMol (normally, not in terminal), In the sidebar go to H - everything then S - sticks and then L - atom identifiers - ID. While in your molecules folder make a file called “Groups.txt” and make list of “your own label” - numbers of atoms that are equivalent (eg H’s on methyl groups) .</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is how you&#39;d make the .txt file in terminal, but using notepad is fine</span>
vim groups.txt
<span class="c1"># Input all the equivalency eg</span>
<span class="c1"># H1 - 72,73,74</span>
:wq
<span class="c1"># save and close file</span>
</pre></div>
</div>
<div class="figure" id="id6">
<img alt="_images/equiv.png" src="_images/equiv.png" />
<p class="caption"><span class="caption-text">Format for doing equivalency maths, note this molecule has C<sub>2</sub> symmetry</span></p>
</div>
</div></blockquote>
<p><strong>13</strong> Run nmr_process.py with equivalency file by specifying equiv as an argument. This will produce two more files in OUTPUT ending in _equiv.txt and _equiv_pretty.txt, The pretty one will show various J couplings &gt; 0.5 Hz and NOEs.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ../../auto-ENRICH/RUN/nmr_process.py equiv
</pre></div>
</div>
</div></blockquote>
<p><strong>Epilogue</strong> Deal with the failures in the failed file by resubmitting them manually</p>
</div>
<div class="section" id="faq">
<span id="id3"></span><h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gaussian.html" class="btn btn-neutral float-right" title="Gaussian" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to wiki_aE’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Will Gerrard and Ollie Dutton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>